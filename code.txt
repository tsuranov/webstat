#######################################################################
feedparser
#######################################################################
отслеживание изменений через feed.etag и feed.modified
https://pythonhosted.org/feedparser/http-etag.html

last_etag = feed.etag
last_modified = feed.modified

feed_update = feedparser.parse(url, etag=last_etag, modified=last_modified)

if feed_update.status == 304:
    # no changes

#######################################################################
feed
item.title			original feed
item.title_detail.value		parser's
item.summary			original feed
item.summary_detail.value	parser's
item.published			original feed
item.published_parsed		parser's
item.link


#######################################################################
lenta.ru
#######################################################################
{'bozo': 0, 'encoding': 'utf-8', 'entries': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, ...], 'etag': 'W/"6796e3c9e1838920...67d27191"', 'feed': {'image': {...}, 'language': 'ru', 'link': 'https://lenta.ru', 'links': [...], 'subtitle': 'Новости, статьи, фо...а в сутки', 'subtitle_detail': {...}, 'title': 'Lenta.ru : Новости', 'title_detail': {...}}, 'headers': {'Cache-Control': 'max-age=0, private,...evalidate', 'Connection': 'close', 'Content-Type': 'application/rss+xml...set=utf-8', 'Date': 'Sun, 15 Jul 2018 11...54:41 GMT', 'ETag': 'W/"6796e3c9e1838920...67d27191"', 'P3P': 'CP="This Is Potato!"', 'Server': 'nginx/1.13.4', 'Set-Cookie': 'lids=48267E3FCD80F4....lenta.ru', 'Status': '200 OK', ...}, 'href': 'https://lenta.ru/rss', 'namespaces': {'': 'http://www.w3.org/2005/Atom'}, 'status': 200, 'version': 'rss20'}
keymap:{'channel': 'feed', 'copyright': 'rights', 'copyright_detail': 'rights_detail', 'date': 'updated', 'date_parsed': 'updated_parsed', 'description': ['summary', 'subtitle'], 'description_detail': ['summary_detail', 'subtitle_detail'], 'guid': 'id', 'issued': 'published', 'issued_parsed': 'published_parsed', 'items': 'entries', 'modified': 'updated', 'modified_parsed': 'updated_parsed', 'tagline': 'subtitle', ...}
items()
['namespaces']:{'': 'http://www.w3.org/2005/Atom'}
['version']:'rss20'
['encoding']:'utf-8'
['etag']:'W/"6796e3c9e183892020ddeea267d27191"'
['href']:'https://lenta.ru/rss'
['bozo']:0
['entries']:[{'guidislink': True, 'id': 'https://lenta.ru/ne..._croatia/', 'link': 'https://lenta.ru/ne..._croatia/', 'links': [...], 'published': 'Sun, 15 Jul 2018 14...:39 +0300', 'published_parsed': time.struct_time(tm_...m_isdst=0), 'summary': 'Большинство российс...Хорватии.', 'summary_detail': {...}, 'tags': [...], ...}, {'guidislink': True, 'id': 'https://lenta.ru/ne...7/15/obr/', 'link': 'https://lenta.ru/ne...7/15/obr/', 'links': [...], 'published': 'Sun, 15 Jul 2018 14...:26 +0300', 'published_parsed': time.struct_time(tm_...m_isdst=0), 'summary': 'Крупнейшая газета Ф... издании.', 'summary_detail': {...}, 'tags': [...], ...}, {'guidislink': True, 'id': 'https://lenta.ru/ne...15/orden/', 'link': 'https://lenta.ru/ne...15/orden/', 'links': [...], 'published': 'Sun, 15 Jul 2018 14...:00 +0300', 'published_parsed': time.struct_time(tm_...m_isdst=0), 'summary': 'Пользователи интерн...ководцев.', 'summary_detail': {...}, 'tags': [...], ...}, {'guidislink': True, 'id': 'https://lenta.ru/ne...5/schoko/', 'link': 'http...
      
        ['link']:'https://lenta.ru/news/2018/07/15/habensky/'
        ['title_detail']:{'base': 'https://lenta.ru/rss', 'language': None, 'type': 'text/plain', 'value': 'Хабенский стал враг...м Украины'}
        ['summary']:'Российский актер и режиссер Константин Хабенский попал в базу данных украинского сайта «Миротворец» за посещение Крыма. В июле 2018 года Хабенский посетил полуостров, где принял участие в фестивале «Алые паруса» в лагере «Артек». Актера обвиняют в «сознательном нарушении государственной границы Украины».'
        ['guidislink']:True
        ['id']:'https://lenta.ru/news/2018/07/15/habensky/'
        ['title']:'Хабенский стал врагом Украины'
        ['links']:[{'href': 'https://lenta.ru/ne...habensky/', 'rel': 'alternate', 'type': 'text/html'}, {'href': 'https://icdn.lenta....be3a3.jpg', 'length': '72056', 'rel': 'enclosure', 'type': 'image/jpeg'}]
        ['summary_detail']:{'base': 'https://lenta.ru/rss', 'language': None, 'type': 'text/html', 'value': 'Российский актер и ...Украины».'}
        ['published_parsed']:time.struct_time(tm_year=2018, tm_mon=7, tm_mday=15, tm_hour=12, tm_min=9, tm_sec=0, tm_wday=6, tm_yday=196, tm_isdst=0)
        ['tags']:[{'label': None, 'scheme': None, 'term': 'Культура'}]
        ['published']:'Sun, 15 Jul 2018 15:09:00 +0300'

['feed']:{'image': {'height': 22, 'href': 'https://assets.lent..._logo.png', 'link': 'https://lenta.ru', 'links': [...], 'title': 'Lenta.ru', 'title_detail': {...}, 'width': 134}, 'language': 'ru', 'link': 'https://lenta.ru', 'links': [{...}, {...}], 'subtitle': 'Новости, статьи, фо...а в сутки', 'subtitle_detail': {'base': 'https://lenta.ru/rss', 'language': None, 'type': 'text/html', 'value': 'Новости, статьи, фо...а в сутки'}, 'title': 'Lenta.ru : Новости', 'title_detail': {'base': 'https://lenta.ru/rss', 'language': None, 'type': 'text/plain', 'value': 'Lenta.ru : Новости'}}
['status']:200
['headers']:{'Cache-Control': 'max-ag


#######################################################################
vedomosti.ru
#######################################################################
{'bozo': 1, 'bozo_exception': CharacterEncodingOve...s utf-8',), 'encoding': 'utf-8', 'entries': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, ...], 'etag': '"5b4b3289-1b21c"', 'feed': {'image': {...}, 'link': 'https://www.vedomosti.ru', 'links': [...], 'subtitle': '"Ведомости". Новост...5.07.2018', 'subtitle_detail': {...}, 'title': '"Ведомости". Ежедне...ая газета', 'title_detail': {...}}, 'headers': {'Accept-Ranges': 'bytes', 'Connection': 'close', 'Content-Length': '111132', 'Content-Type': 'text/xml', 'Date': 'Sun, 15 Jul 2018 12...09:10 GMT', 'ETag': '"5b4b3289-1b21c"', 'Last-Modified': 'Sun, 15 Jul 2018 11...39:53 GMT', 'Server': 'nginx', 'Strict-Transport-Security': 'max-age=16000000; preload;'}, 'href': 'https://www.vedomos.../rss/news', 'namespaces': {}, 'status': 200, 'updated': 'Sun, 15 Jul 2018 11...39:53 GMT', 'updated_parsed': time.struct_time(tm_...m_isdst=0), 'version': 'rss20'}
keymap:{'channel': 'feed', 'copyright': 'rights', 'copyright_detail': 'rights_detail', 'date': 'updated', 'date_parsed': 'updated_parsed', 'description': ['summary', 'subtitle'], 'description_detail': ['summary_detail', 'subtitle_detail'], 'guid': 'id', 'issued': 'published', 'issued_parsed': 'published_parsed', 'items': 'entries', 'modified': 'updated', 'modified_parsed': 'updated_parsed', 'tagline': 'subtitle', ...}
items()
['bozo']:1
['href']:'https://www.vedomosti.ru/rss/news'
['updated_parsed']:time.struct_time(tm_year=2018, tm_mon=7, tm_mday=15, tm_hour=11, tm_min=39, tm_sec=53, tm_wday=6, tm_yday=196, tm_isdst=0)
['namespaces']:{}
['feed']:{'image': {'href': 'https://cdn.vdmsti...._logo.gif', 'link': 'https://www.vedomosti.ru', 'links': [...], 'title': '"Ведомости". Ежедне...ая газета', 'title_detail': {...}}, 'link': 'https://www.vedomosti.ru', 'links': [{...}], 'subtitle': '"Ведомости". Новост...5.07.2018', 'subtitle_detail': {'base': 'https://www.vedomos.../rss/news', 'language': None, 'type': 'text/html', 'value': '"Ведомости". Новост...5.07.2018'}, 'title': '"Ведомости". Ежедне...ая газета', 'title_detail': {'base': 'https://www.vedomos.../rss/news', 'language': None, 'type': 'text/plain', 'value': '"Ведомости". Ежедне...ая газета'}}
['version']:'rss20'
['status']:200
['encoding']:'utf-8'
['bozo_exception']:CharacterEncodingOverride('document declared as us-ascii, but parsed as utf-8',)
['etag']:'"5b4b3289-1b21c"'
['headers']:{'Accept-Ranges': 'bytes', 'Connection': 'close', 'Content-Length': '111132', 'Content-Type': 'text/xml', 'Date': 'Sun, 15 Jul 2018 12...09:10 GMT', 'ETag': '"5b4b3289-1b21c"', 'Last-Modified': 'Sun, 15 Jul 2018 11...39:53 GMT', 'Server': 'nginx', 'Strict-Transport-Security': 'max-age=16000000; preload;'}
['entries']:[{'author': '', 'authors': [...], 'guidislink': False, 'id': 'https://www.vedomos...n-peredal', 'link': 'https://www.vedomos...n-peredal', 'links': [...], 'pdalink': 'https://m.vedomosti...n-peredal', 'published': 'Sun, 15 Jul 2018 14...:58 +0300', 'published_parsed': time.struct_time(tm_...m_isdst=0), ...}, {'author': '', 'authors': [...], 'guidislink': False, 'id': 'https://www.vedomos...za-trampa', 'link': 'https://www.vedomos...za-trampa', 'links': [...], 'pdalink': 'https://m.vedomosti...za-trampa', 'published': 'Sun, 15 Jul 2018 13...:08 +0300', 'published_parsed': time.struct_time(tm_...m_isdst=0), ...}, {'author': '', 'authors': [...], 'guidislink': False, 'id': 'https://www.vedomos...r-vengrii', 'link': 'https://www.vedomos...r-vengrii', 'links': [...], 'pdalink': 'https://m.vedomosti...r-vengrii', 'published': 'Sun, 15 Jul 2018 13...:03 +0300', 'published_parsed': time.struct_time(tm_...m_isdst=0), ...}, {'author': '', 'authors': [...], 'guidislink': False, 'id': 'https://www.vedomos...sk-trampa', '...
     
        ['pdalink']:'https://m.vedomosti.ru/politics/news/2018/07/15/775519-putin-peredal'
        ['tags']:[{'label': None, 'scheme': None, 'term': 'Политика'}]
        ['author']:''
        ['guidislink']:False
        ['link']:'https://www.vedomosti.ru/politics/news/2018/07/15/775519-putin-peredal'
        ['authors']:[{}]
        ['published']:'Sun, 15 Jul 2018 14:03:58 +0300'
        ['title_detail']:{'base': 'https://www.vedomos.../rss/news', 'language': None, 'type': 'text/plain', 'value': 'Путин передал Катар...ся опытом'}
        ['id']:'https://www.vedomosti.ru/politics/news/2018/07/15/775519-putin-peredal'
        ['links']:[{'href': 'https://www.vedomos...n-peredal', 'rel': 'alternate', 'type': 'text/html'}]
        ['title']:'Путин передал Катару «мяч полномочий» и обещал поделиться опытом'
        ['published_parsed']:time.struct_time(tm_year=2018, tm_mon=7, tm_mday=15, tm_hour=11, tm_min=3, tm_sec=58, tm_wday=6, tm_yday=196, tm_isdst=0)

['updated']:'Sun, 15 Jul 2018 11:39:5

#######################################################################
asyncpg
#######################################################################
https://habr.com/post/337420/
https://magicstack.github.io/asyncpg/current/
https://magicstack.github.io/asyncpg/current/usage.html
-> python asyncpg


async def gr1():
	await asyncio.sleep(2)
async def gr2():
	await asyncio.sleep(2)
async def gr3():
	await asyncio.sleep(2)


ioloop = asyncio.get_event_loop()
tasks = [
    ioloop.create_task(gr1()),
    ioloop.create_task(gr2()),
    ioloop.create_task(gr3())
]
ioloop.run_until_complete(asyncio.wait(tasks))
ioloop.close()

#######################################################################
work
#######################################################################

#print ("Start read RSS")
#url = 'https://lenta.ru/rss'
#rssdates = feedparser.parse(url)

async def run():
    conn = await asyncpg.connect(user='webuser', password='!23456', database='webstat', host='10.10.10.10')
    values = await conn.fetch('''SELECT * FROM rss_lenta_ru''')
    await conn.close()

loop = asyncio.get_event_loop()
loop.run_until_complete(run())

#######################################################################
date & time
#######################################################################

#print (item.published, "\n")
Fri, 15 Jun 2018 13:49:00 +0300
Fri, 15 Jun 2018 13:47:00 +0300
Fri, 15 Jun 2018 13:41:00 +0300
Fri, 15 Jun 2018 13:32:00 +0300
Fri, 15 Jun 2018 13:30:57 +0300
Fri, 15 Jun 2018 13:30:51 +0300
"%a, %d %b %Y %H:%M:%S +0000"


#postgresql
1971-07-13 00:00:00+05

strftime("%Y-%m-%d %H:%M:%S+00")


print ("\n")
tt = datetime.datetime.strptime("Fri, 15 Jun 2018 13:30:51 +0300", "%a, %d %b %Y %H:%M:%S %z")
print ("\n")



















